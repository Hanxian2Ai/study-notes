# 操作系统概述

## 什么是操作系统？

> 管理计算机**硬件**与**软件**资源的**计算机程序**
>
> 构成：用户、用户程序、操作系统OS、硬件
>
> 是一种系统软件，与硬件交互，对资源共享进行调度管理、解决并发操作中的协调问题、数据结构复杂、外部接口多样化
>
> **总结就是：一个系统软件，管理硬件，协调软件、服务用户**

## 操作系统有哪些功能？

> 有效性、方便性、可扩充性、开放性
>
> - 提高系统资源利用率
> - 提高系统的吞吐量
>
> OS进行资源的管理
>
> - 处理机管理（进程）
> - 存储器管理（内存）
> - IO设备管理（输入输出设备）
> - 文件管理 （文件目录）
>
> OS作为用户与计算机硬件系统之间的接口
>
> - 程序接口
> - 命令接口
> - GUI
>
> OS实现了对计算机资源的抽象/作为扩充机器
>
> - 将具体的硬件资源抽象成软件资源，方便用户
> - 开放了简单的访问方式隐藏了实现细节

## 操作系统有哪些特征？

> - 并发
>
>   - 同一个时间间隔内**执行和调度**多个程序的能力
>     - 宏观 同时处理
>     - 微观 分时交替执行
>   - 相似概念 并行
>     - 同一时刻（时间点）发生的事件数量
>
> - 共享
>
>   即资源共享，系统中的资源供多个并发执行的应用程序共同使用
>
>   - 同时访问方式：同一时段允许多个程序同时访问共享资源
>   - 互斥共享方式：也叫独占式
>
> - 虚拟
>
>   使用技术把一个物理实体变为多个逻辑上的对应物
>
>   - 时分复用
>   - 空分复用：一块硬盘虚拟出若干个卷
>
> - 异步（Asynchronism）
>
>   多道程序环境下，允许多个程序并发执行；
>
>   单处理机环境下，多个程序分时交替执行；
>
>   

## 操作系统是怎么发展过来的？

单道批处理与多道批处理系统对比

分时操作系统（Time Sharing System）

> 人机交互、共享主机、便于用户上级
>
> 关键问题：**及时**接受、**及时**处理
>
> 特征：
>
> - 多路性：时间片轮转机制
> - 独立性：用户彼此独立
> - 及时性：用户能在短时间内获得响应
> - 交互性：用户可以请求多种服务
>
> 缺点：
>
> - 优先级相同，不能处理紧急任务

实时操作系统

> 能及时响应外部事件的请求，在规定的时间内完成对该事件的处理，并控制所有实时任务协调一致地运行。
>
> 实时任务
>
> - 周期性/非周期性任务（根据周期性）
> - 硬/软实时任务（根据截止事件）
>
> **可靠性**：**多级容错，保障系统和数据的安全**

微机操作系统的发展

> 单用户单任务
>
> 多用户多任务
>
> - UnixOS:Linux
> - Win10

其他操作系统

> 网络操作系统
>
> - 资源共享
> - 远程通信
>
> 分布式操作系统
>
> - 分布性
> - 并行性

## 操作系统的运行机制是怎样的？

为什么要有内核态和用户态？

> - 安全性：防止用户态程序对计算机底层的资源的恶意访问和篡改
> - 隔离性：防止用户态的某些程序奔溃影响其他正在运行的程序

- 几个基本概念
  - 内核程序 --> 应用程序
  - 核心态-->用户态
  - 特权指令 -->非特权指令

- 时钟管理（硬件设备）✨✨✨✨

  - 记时：提供系统时间
  - 时钟中断：比如进程切换

- **中断机制✨✨✨✨** ****

  - 提高多道程序环境下CPU利用率
  - 外中断：外部设备
  - 内中断：当前指令
    - 陷阱：由应用程序主动引发
    - 故障：由错误条件引发
    - 终止：由致命错误引发

- **中断处理过程✨✨✨✨**

  1. 关中断（CPU不响应高级中断请求 ）
  2. 保存断点，保存的程序计数器
  3. 引出中断服务程序
  4. **保存现场和屏蔽字**
  5. 开中断
  6. 执行中断服务程序
  7. 关中断
  8. **恢复线程和屏蔽字**
  9. 开中断
  10. 中断返回

  > 记住一共3大步，1、保存现场 2、执行中断服务程序 3、恢复现场

- **原语（一个程序段，就是靠开中断和关中断实现的）**

  - 由若干指令组成
  - 用来完成某个特定功能
  - 执行过程不会被中断

- 系统数据结构

  - 进程管理：作业控制块、进程控制块
  - 存储器管理：存储器分配与回收
  - 设备管理：缓冲区、设备控制块

- **系统调用（通过陷入指令）**

  - 由操作系统实现，给应用程序调用
  - 是一套接口的集合
  - 应用程序访问内核服务的方式

## 操作系统的结构是怎样设计的？

- 第一代：无结构OS

  一系列过程（程序）的集合，过程间可以相互调用

  结构复杂且混乱，难以调试、阅读和维护



- 第二代：模块化结构OS：模块-接口法OS

  基于“分解”和“模块化”原则

  按照功能划分模块/子模块，规定模块间的接口

  模块独立性标准：**高内聚、低耦合**



- 第三代：分层式结构OS

  有序分层法，自顶向下依次依赖

  设计时，自底向上：每一步建立在可靠的基础上

  优缺点：

  ​	容易保证系统正确性

  ​	容易扩充和维护

  ​	自上而下的层次通信，导致系统效率降低

- 第三代：微内核OS结构

  微内核的基本概念

  **足够小的内核，只实现OS核心功能**

  ​	例如进程调度微内核、低级存储器管理、中断和陷入管理

  ​	与硬件处理紧密相关的部分，比如硬件处理、
   客户与服务器通信和其它基本功能

  ​	一些较基本的功能

  ​	客户和服务器之间通信（**客户/服务器模式**）

  应用“机制与策略分离”原理

  采用面向对象技术