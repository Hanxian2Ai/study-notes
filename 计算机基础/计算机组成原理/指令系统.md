## 指令系统

### 指令格式

- 指令的基本格式

  - 基本概念：计算机运行的最小功能单位
  - 结构
    - 操作码：执行什么操作功能（算术、逻辑、移位运算、转移操作、输入输出操作）
    - 地址码：给出被操作信息或数据的地址（操作数地址、运算结果地址、程序转移地址、子程序入口地址）
    - 指令字长：定长或者可变，与机器字长无关，大于的话一般未机器字长的两倍，小于的话是机器字长一般

- 地址码的个数

  - 零地址：不需要操作数（空操作、停机、关中断指令）

  - 一地址：单操作数/双操作数指令

    > 单：OP（A1）->A1 取A1地址进行OP操作，再把值放到这个位置，比如i++，求补码等
    >
    > 双：（ACC）OP（A1）->ACC 累加器

  - 二地址：(A1)OP(A2)->A1 高位地址为目的操作数

  - 三地址：(A1)OP(A2)->A3

  - 四地址：(A1)OP(A2)->A3 A4下一条要执行指令的地址

### 指令的寻址方式

- 指令寻址和数据寻址

  - 基本概念
    - 指令寻址：寻找下一条将要执行的指令地址
    - 数据寻址
  - 指令寻址
    - 顺序寻址：通过程序计数器自动加1（1个指令字长）实现
    - 跳跃寻址：通过转移类指令实现,例如JMP无条件转移指令
      - 本条指令给出下条指令的计算方式
      - 本条指令修改PC值，由PC给出下条指令地址

- 常见的数据寻址方式

  - 数据寻址（一地址指令组成：OP+MOD(寻址特征，每个数据地址前都有)+A1）

    - 形式地址A：地址码不是操作数真实地址
    - 有效地址EA：形式地址结合寻址特征，计算出真实地址

  - 方式

    - 隐含寻址：单地址指令，第二个操作数默认为ACC(累加器)

    - 立即寻址：形式地址A即操作数本身，又称立即数，补码形式；特征位# 表示立即寻址；优点：不访问内存，速度快；缺点：立即数A的位数限制了范围

    - 直接寻址：形式地址A是操作数的真实地址，即EA=A；优点：简单，执行阶段仅需一次访存，不需要计算操作数的地址；缺点：A的位数决定寻址方位，操作数地址变化引起指令地址修改，编程不便

    - 间接寻址：形式地址不是真实地址，而是有效地址所在存储单元地址 ，可以一次间址，也可以多次：1开头-地址，0开头-EA；优点：可扩大寻址范围，便于编制程序；缺点：要访问多次，访问速度慢

    - 寄存器寻址：在指令中直接给出操作数的寄存器编号；优点：指令执行阶段不访存，支持向量，矩阵运算；缺点：寄存器价格昂贵

    - 寄存器间接寻址：寄存器Ri给出操作数主存单元地址。EA=(Ri),比间接寻址快，比寄存器寻址慢

    - 基址寻址：基址寄存器BR内容加上指令中的形式地址A，得到有效地址EA=(BR)+A；优点：不必考虑程序存在主存的哪个区域，有利于多道程序，可用于浮动程序；缺点：偏移量位数较(形式地址A)短

    - 变址寻址：EA=(IX)+A,基址不变，偏移量可变；便于处理数组，A为数组首地址，不断改变IX内存，可得数据任一地址；缺点：基地址（形式地址A）位数较短

    - 相对寻址：把PC内容加上形式地址A，EA=（PC)+A,A相当于当前地址得偏移量，可正可服负；优点：便于程序浮动，应用于转移指令

    - 堆栈寻址：主存和寄存器中一块特定得存储区(LIFO,后进先出)，读写地址由特定寄存器给出，叫堆栈指针（SP）；适用于堆栈结构计算机，多用无操作数指令；读写前后伴有自动完成对SP增量或减量操作

      ![image-20231013170125068](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20231013170125068.png)